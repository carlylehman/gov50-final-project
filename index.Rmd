---
title: "Gov 50 Final Project"
author: "Carly Lehman"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts
  I am interested in exploring data related to the effect exposure to diverse political views has on individuals' political polarization. Oftentimes, an assumption is made that exposing individuals to diverse public opinions will decrease polarization. Instead of relying on this as a common assumption, I want to test whether individuals exposed to opposing political opinions will become more or less polarized. I specifically want to understand whether exposure to diverse political views changes individuals' views on homosexuality. I find the survey questions on homosexuality an especially interesting aspect of this dataset as it is a political issue often perceived to be influenced by religion and societal values, not social media. Understanding to what extent an exposure to diverse political views affects views on homosexuality, versus individuals other demographic factors, will help to understand whether views on homosexuality are driven by social media or outside factors. To do this, I am using a dataset from Bail et. al. 2018 which measured individuals political polarization before and after interacting with twitter bots of opposing political viewpoints. Bail et. al asks a variety of survey questions to measure political polarization, with about half dealing with economic issues and the other half dealing with social issues. The data set utilized 901 democrats and 751 republicans in its survey, collecting information about gender, geographic region, education, and twitter use as well. The specific survey question around homosexuality is posed as “Homosexuality should be accepted by society”, a broad question that leaves out legal opinions, such as asking about gay marriage, and instead just focuses on societal views. The many control variables collected will allow for a better understanding of the effect of the independent variable, instead of it being corrupted by outside variables. One downside to this dataset is that it is testing changes in views and polarization through twitter, a social media platform that is historically polarized. The effects of exposure to opposing views would surely be deferred if the exposure occurred in person, and not over social media. 
  My hypothesis is that exposure to diverse political views on social media will have a small effect on individuals' views towards homosexuality. Although I think there will be an effect, making individuals more accepting or more skeptical, I think the effect will be smaller than the effect of the treatment on economic or other, less religious based, social issues. I think that when faced with twitter bots espousing differing views to their own, users will revert to the inherent belief system that makes them unaccepting of LGBTQ individuals, and not feel especially moved to change their views by a stranger on the internet. Additionally, I think that outside demographic effects will have an effect on individuals towards homosexuality, as studies have shown that younger generations and women have more progressive views towards the LGTBQ+ population. This hypothesis is important for the future to understand the best way to address individuals and communities hostile to LGBTQ populations, whether it be through exposure to contrasting views or through addressing their root belief systems. It will also help to clarify the role social media plays in negative views towards homosexuality, or whether it is more of a forum for people to express their views instead of informing them. 

 
```{r}
library(dplyr)
library(tidyverse)
library(infer)

twitter_data <- read_csv("gov-50-final-project-twitter-data.csv")
```


```{r}

twitter_data <- twitter_data  |> 
  na.omit(twiiter_data)

visualize_ec <- twitter_data  |> 
  mutate(gender = if_else(gender == 1, "female", "male")) |>
  group_by(gender) |>
  summarize(gender_homosexuality = mean(homosexuality_should_be_accepted_wave_5)) |>
  ggplot(mapping = aes(x = gender, y = gender_homosexuality)) + geom_col()
   visualize_ec
   

    
```
```{r}
library(infer)
set.seed(02138)

twitter_data <- twitter_data |>
  mutate(treatment = if_else(treat == 1, "Exposure","Control")) 

ate_twitter <- twitter_data |>
  rep_slice_sample(prop = 1, replace = TRUE, reps = 1000) |>
   group_by(replicate, treatment) |>
  na.omit() |> 
  summarize(mean_ideology = mean(homosexuality_should_be_accepted_wave_5)) |>
   pivot_wider(
    names_from = c(treatment), 
    values_from = mean_ideology) |>
  mutate(ATE = `Exposure` - `Control`) |>
  select(ATE)


ate_twitter_ci_95 <- ate_twitter |>
  select(replicate, ATE) |>
  na.omit() |>
  get_confidence_interval(level = 0.95) 

 ate_twitter  |>
  ggplot(aes(x = ATE)) + 
  geom_histogram(aes(y = after_stat(density)), binwidth = 0.05) +
  geom_vline(xintercept = unlist(ate_twitter_ci_95))
 
 
```
Visualization #2 Data section: The results from this analysis, a replication of the data to evaluate the null hypothesis and understand the confidence intervals, provide us with several important data sets to analyze the relationship between the treatment effect and views on whether homosexuality should be accepted in society. The ate_twitter provides the 1,000 replications and their stats, or the expected statistical significance of the treatment on individuals views on homosexuality, while the ATE variable summarizes these replications together to find the overall Average treatment effect (ATE), which is -0.124. Beyond the ATE, this data visualization also provides the upper and lower confidence intervals, which for lower is -1.38 and for the upper is 1.078. With a 95% confidence interval, you expect values to fall between these upper and lower boundaries 95% of the time. The lower Confidence interval provides the lower average treatment effect boundary, besides the 2.5% outliers and the lower Confidence interval provides the upper average treatment effect boundary, besides the 2.5% outlier. The alpha and confidence level are also intertwined, and because we used a 95% confidence level, our alpha would be 0.05. ]
  With an alpha of 0.05, and a p-value from the data of 0.338, we can see that the p-value is above the alpha. Because of both the fact that 0 falls between the upper and lower boundaries of the CI and that the p-value is above the alpha, we can fail to reject the null hypothesis based on this data. In failing to reject the null hypothesis, we are making a statement that there is no statistically significant effect of the treatment on the dependent variable. In failing to reject a null hypothesis, there is a possibility of a type II error which is when we fail to reject the null hypothesis but there actually exists an effect of the treatment on the dependent variable. Although a type II error would be detrimental, it is not regarded as bad a type I error. One way to attempt to mitigate a type II error is to increase the sample size, or amount of replications, as it would give a more precise P-value and CI. 


Visualization #2 results section: From this plot and its data, we can see that the treatment effect was not significantly significant on individuals' views towards the statement “Homosexuality should be accepted by society.” From the codebook of the study, we can see that a more negative score is a more liberal view towards the question, more accepting of homosexuality, while a positive score is less accepting of homosexuality. In having an ATE of -0.124, as calculated through the data, there is a relationship in which there is small difference in views between the treatment, or exposure group, and the control group. Although this small relationship does exist, the confidence intervals and p-value below the alpha highlights that there is no observed effect between the treatment and individuals views on the acceptance of homosexuality in society. In failing to reject the null hypothesis, it means there is no sufficient evidence for an observed effect, or in other words that the effect of the treatment on whether individuals become more or less positive towards homosexuality in society was not statistically significant. To further understand the ATE and the lack of statistical significance, a regression can be done to look at the effect of the treatment on individuals' views towards homosexuality in comparison to the effect of demographic information, such as age and gender. 

modelsummary::modelsummary(fit_ate,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))
```{r}
library(stargazer)
install.packages("stargazer")

fit_ate <- lm(homosexuality_should_be_accepted_wave_5 ~ treat + birth_year + family_income + education + gender + homosexuality_should_be_accepted_wave_1 + northeast + north_central + south + west, data = twitter_data)
  
summary(fit_ate)

stargazer(fit_ate, data = "text")
```
Visualization #2 Data section: This regression shows the effect of the treatment coefficient on the dependent variable, individuals views torwards the acceptance of homosexuality in the study, along with the signifiance of other demographic characteristics. The regression includes the ATE, the standard deviation, and the p value for both the treatment effect, but also all of the control variables. From this regression, the intercept, which is the expected change from the treatment effect when all indepenent variables are 0, is -8.51. The expected standard deviation is 28.4 and the expect p value is 0.768. For the treatment coefficient, the regression tells us that the 
Visualization #2 results section:
```{r}
ate  <- twitter_data |>
  specify(homosexuality_should_be_accepted_wave_5 ~ treatment) |>
calculate(stat = "diff in means", order = c("Exposure","Control"))

ate_null_dist <- twitter_data |>
   specify(homosexuality_should_be_accepted_wave_5 ~ treatment) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
    calculate(stat = "diff in means", order = c("Exposure","Control")) 

ate_p <- ate_null_dist |>
  get_p_value(obs_stat = ate, direction = "both")

ate_null_dist |> 
  visualize() + shade_p_value(obs_stat = ate, direction = "both")
```

