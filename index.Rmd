---
title: "Gov 50 Final Project"
author: "Carly Lehman"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts
 I am interested in exploring data related to the effect of exposure to diverse political views has on individuals political polarization. Often times, an assumption is made that exposing individuals to diverse public opinions will decrease polarization. Instead of relying on this as a common assumption, I want to test whether individuals exposed to opposing political opinions will become more or less polarized. I specifically want to understand whether the effect of cross-party interaction effects social or economic political polarization more. To do this, I am using a dataset from Bail et. al. 2018 which measured individuals political polarization before and after interacting with twitter bots of opposing political viewpoints. Bail et. al asks a variety of survey questions to measure political polarization, with about half dealing with economic issues and the other half dealing with social issues. An example of an economic measure is “Government regulation of business is necessary to protect the public interest” and an example of an economic measure is “Homosexuality should be accepted by society.” The data set utilized 901 democrats and 751 republicans in its survey, collecting information about gender, geographic region, education, and twitter use as well. The many control variables collected will allow for a better understanding of the effect of the independent variable, instead of it being corrupted by outside variables. One downside to this dataset is that it is testing changes in views and polarization through twitter, a social media platform that is historically polarized. The effects of exposure to opposing views may differ if that exposure occured in person, and not over social media. 
 
 
```{r}
library(dplyr)
library(tidyverse)
library(infer)

twitter_data <- read_csv("gov-50-final-project-twitter-data.csv")
```


```{r}

twitter_data <- twitter_data  |> 
  na.omit(twiiter_data)

visualize_ec <- twitter_data  |> 
  mutate(gender = if_else(gender == 1, "female", "male")) |>
  group_by(gender) |>
  summarize(mean_homogeneity = mean(ideo_homogeneity_offline)) |>
  ggplot(mapping = aes(x = gender, y = mean_homogeneity)) + geom_col()
   visualize_ec
   

    
```
```{r}
library(infer)
set.seed(02138)

twitter_data <- twitter_data |>
  mutate(treatment = if_else(treat == 1, "Exposure","Control")) 

ate_twitter <- twitter_data |>
  rep_slice_sample(prop = 1, replace = TRUE, reps = 1000) |>
   group_by(replicate, treatment) |>
  na.omit() |> 
  summarize(mean_ideology = mean(homosexuality_should_be_accepted_wave_5)) |>
   pivot_wider(
    names_from = c(treatment), 
    values_from = mean_ideology) |>
  mutate(ATE = `Exposure` - `Control`) |>
  select(ATE)


ate_twitter_ci_95 <- ate_twitter |>
  select(replicate, ATE) |>
  na.omit() |>
  get_confidence_interval(level = 0.95) 

 ate_twitter  |>
  ggplot(aes(x = ATE)) + 
  geom_histogram(aes(y = after_stat(density)), binwidth = 0.05) +
  geom_vline(xintercept = unlist(ate_twitter_ci_95))
 
 
```

```{r}
install.packages("modelsummary")

fit_ate <- lm(homosexuality_should_be_accepted_wave_5 ~ treat + birth_year + family_income + education + gender + homosexuality_should_be_accepted_wave_1 + northeast + north_central + south + west, data = twitter_data)
  

modelsummary::modelsummary(fit_ate,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared", "adj.r.squared"))
```
```{r}
ate  <- twitter_data |>
  specify(homosexuality_should_be_accepted_wave_5 ~ treatment) |>
calculate(stat = "diff in means", order = c("Exposure","Control"))

ate_null_dist <- twitter_data |>
   specify(homosexuality_should_be_accepted_wave_5 ~ treatment) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
    calculate(stat = "diff in means", order = c("Exposure","Control")) 

ate_p <- ate_null_dist |>
  get_p_value(obs_stat = ate, direction = "both")

ate_null_dist |> 
  visualize() + shade_p_value(obs_stat = ate, direction = "both")
```

